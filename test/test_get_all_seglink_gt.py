import numpy as np
from tf_extended.seglink import get_all_seglink_gt
import config

image_shape = (512, 1024)

config.init_config(image_shape, batch_size=2)

x1 = [0.7679688 , 0.8109375 , 0.7476562 , 0.80625   , 0.753125  ,
       0.28359374, 0.77734375, 0.21953125, 0.759375  , 0.7992188 ,
       0.828125  , 0.79765624, 0.67578125, 0.68671876, 0.6773437 ,
       0.41171876, 0.40625   , 0.221875  , 0.23828125, 0.225     ,
       0.24375   ]
x2 = [0.8125    , 0.8539063 , 0.80625   , 0.8335937 , 0.77734375,
       0.31328124, 0.83203125, 0.278125  , 0.79765624, 0.8257812 ,
       0.8492187 , 0.8359375 , 0.68828124, 0.7242187 , 0.73828125,
       0.42578125, 0.43203124, 0.2390625 , 0.25625   , 0.24375   ,
       0.2625    ]
x3 = [0.815625  , 0.8578125 , 0.80859375, 0.83671874, 0.7828125 ,
       0.31484374, 0.8390625 , 0.28125   , 0.8023437 , 0.8296875 ,
       0.853125  , 0.840625  , 0.68828124, 0.72578126, 0.73828125,
       0.42890626, 0.434375  , 0.240625  , 0.26015624, 0.24453124,
       0.2625    ]
x4 = [0.7710937 , 0.815625  , 0.75078124, 0.80859375, 0.75859374,
       0.28515625, 0.784375  , 0.221875  , 0.7640625 , 0.8023437 ,
       0.83125   , 0.8023437 , 0.67578125, 0.68828124, 0.6773437 ,
       0.41484374, 0.40859374, 0.2234375 , 0.2421875 , 0.2265625 ,
       0.24375   ]

y1 = [0.3625    , 0.34305555, 0.2375    , 0.20555556, 0.28194445,
       0.06111111, 0.26666668, 0.05555556, 0.32222223, 0.30555555,
       0.29444444, 0.3986111 , 0.36805555, 0.3625    , 0.3861111 ,
       0.7013889 , 0.7222222 , 0.5777778 , 0.5694444 , 0.6027778 ,
       0.5972222 ]
y2 = [0.34305555, 0.3263889 , 0.20972222, 0.19444445, 0.27083334,
       0.06666667, 0.24166666, 0.06111111, 0.30555555, 0.29444444,
       0.2847222 , 0.38333333, 0.36527777, 0.34861112, 0.36527777,
       0.6944444 , 0.70694447, 0.575     , 0.56527776, 0.6       ,
       0.59305555]
y3 = [0.37083334, 0.35277778, 0.2361111 , 0.21944444, 0.29305556,
       0.10833333, 0.26805556, 0.10416666, 0.33333334, 0.32083333,
       0.30694443, 0.4097222 , 0.38055557, 0.3638889 , 0.38055557,
       0.70694447, 0.725     , 0.5986111 , 0.59305555, 0.62222224,
       0.6166667 ]
y4 = [0.39027777, 0.36944443, 0.2638889 , 0.23194444, 0.30277777,
       0.10277778, 0.29305556, 0.09861111, 0.35      , 0.33055556,
       0.31527779, 0.425     , 0.38333333, 0.37777779, 0.4027778 ,
       0.7152778 , 0.74027777, 0.6013889 , 0.5972222 , 0.6263889 ,
       0.61944443]

gxs = np.transpose(np.stack([x1, x2, x3, x4]))
gys = np.transpose(np.stack([y1, y2, y3, y4]))
ignored = np.array([0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1])

h_I, w_I = config.image_shape

gxs *= w_I
gys *= h_I

seg_labels, seg_offsets, link_labels = get_all_seglink_gt(gxs, gys, ignored)
print()